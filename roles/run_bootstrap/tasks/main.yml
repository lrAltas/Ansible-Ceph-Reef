# SPDX-License-Identifier: MIT-0
---
# tasks file for roles/run_bootstrap
- name: Check if the tasks has been running
  block:
    - name: Ensure Mark Directory Exists
      ansible.builtin.file:
        path: "{{ run_bootstrap_mark_dir_path }}"
        state: directory
        mode: '0755'

    - name: Check if run_bootstrap tasks have been run
      ansible.builtin.stat:
        name: "{{ run_bootstrap_mark_file_path }}"
      register: run_bootstrap_mark_file

    - name: Skip if run_bootstrap tasks have been run
      ansible.builtin.meta: end_role
      when: run_bootstrap_mark_file.stat.exists

- name: Run Cephadm Bootstrap
  ansible.builtin.import_tasks: bootstrap_mon_node.yml
  tags: bootstrap_mon_node

- name: Create mark file to indicate run_bootstrap tasks have been run
  ansible.builtin.file:
    path: "{{ run_bootstrap_mark_file_path }}"
    state: touch
    mode: '0644'
